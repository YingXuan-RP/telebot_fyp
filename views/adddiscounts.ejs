<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Discount - TeleBuy Admin</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<div class="app-container">

<!-- Sidebar -->
<aside class="sidebar">

    <div class="sidebar-header">
        <h2>ğŸ¤– TeleBuy Admin</h2>
    </div>

    <nav class="sidebar-nav">

        <a href="/admin/homepage" class="nav-item">
            <span class="nav-icon">ğŸ“Š</span>
            <span class="nav-text">Home</span>
        </a>

        <a href="/admin/categories" class="nav-item">
            <span class="nav-icon">ğŸ“</span>
            <span class="nav-text">Categories</span>
        </a>

        <!-- Products Dropdown (KEEP) -->
        <div class="nav-dropdown">
            <button class="nav-dropdown-toggle">
                <div style="display:flex;align-items:center;">
                    <span class="nav-icon">ğŸ›ï¸</span>
                    <span class="nav-text">Products</span>
                </div>
                <span class="dropdown-arrow">â–¶</span>
            </button>

            <div class="nav-submenu">
                <a href="/admin/products" class="nav-item">All Products</a>
                <a href="/admin/inventory" class="nav-item">Inventory</a>
            </div>
        </div>

        <!-- Customers -->
        <a href="/users" class="nav-item">
            <span class="nav-icon">ğŸ‘¥</span>
            <span class="nav-text">Customers</span>
        </a>

        <!-- âœ… Orders (NOW SIMPLE LINK) -->
        <a href="/orders" class="nav-item">
            <span class="nav-icon">ğŸ“¦</span>
            <span class="nav-text">Orders</span>
        </a>

        <a href="/discounts" class="nav-item">
            <span class="nav-icon">ğŸ·ï¸</span>
            <span class="nav-text">Discounts</span>
        </a>

        <a href="/analytics" class="nav-item">
            <span class="nav-icon">ğŸ“ˆ</span>
            <span class="nav-text">Analytics</span>
        </a>

    </nav>

    <!-- Notifications -->
    <div class="sidebar-notifications">
        <div class="notifications-header">
            <span>Notifications</span>
            <span class="notifications-count" id="notifCount"></span>
        </div>

        <div class="notifications-list" id="notificationsList"></div>
    </div>

    <form action="/logout" method="POST">
        <button type="submit" class="btn btn-secondary btn-block">
            Logout
        </button>
    </form>

</aside>

<!-- ================= MAIN ================= -->
<main class="main-content">

<header class="content-header">
  <h1>Create Discount</h1>
</header>

<div class="content-body">

<form action="/discounts/add" method="POST" class="form-card">

<!-- CODE -->
<div class="form-group">
  <label>Discount Code *</label>
  <input type="text" name="code" required placeholder="e.g NEWYEAR2026">
</div>

<!-- TYPE -->
<div class="form-group">
  <label>Discount Type *</label>
  <select name="type" required>
    <option value="percentage">Percentage (%)</option>
    <option value="fixed">Fixed Amount (SGD)</option>
  </select>
</div>

<!-- VALUE -->
<div class="form-group">
  <label>Discount Value *</label>
  <input type="number" name="value" step="0.01" min="0" required>
</div>

<!-- USAGE LIMIT -->
<div class="form-group">
  <label>Usage Limit (0 = Unlimited)</label>
  <input type="number" name="usage_limit" min="0" value="0">
</div>

<!-- MIN PURCHASE -->
<div class="form-group">
  <label>Minimum Purchase (SGD)</label>
  <input type="number" name="minimum_purchase" step="0.01" min="0" value="0">
</div>

<!-- APPLY SCOPE -->
<div class="form-group">
  <label>Apply Discount To *</label>
  <select name="apply_scope" id="applyScope" required>
    <option value="all">All Categories</option>
    <option value="selected">Selected Categories</option>
  </select>
</div>

<!-- MULTI CATEGORY SELECT -->
<div class="form-group" id="categoryBox" style="display:none;">
  <label>Select Categories</label>

  <select name="selected_categories" multiple style="height:150px;">
    <% if (categories && categories.length > 0) { %>
      <% categories.forEach(cat => { %>
        <option value="<%= cat.id %>"><%= cat.name %></option>
      <% }) %>
    <% } %>
  </select>

  <small style="color:#888;">
    Hold CTRL (Windows) or CMD (Mac) to select multiple
  </small>
</div>

<!-- VALID UNTIL -->
<div class="form-group">
  <label>Valid Until *</label>
  <input type="date" name="valid_until" required>
</div>

<!-- ACTIVE -->
<div class="form-group checkbox">
  <label>
    <input type="checkbox" name="is_active" checked>
    Active
  </label>
</div>

<!-- ACTIONS -->
<div class="form-actions">
  <a href="/discounts" class="btn btn-secondary">Cancel</a>
  <button type="submit" class="btn btn-primary">Save Discount</button>
</div>

</form>
</div>
</main>
</div>

<!-- ================= SCRIPT ================= -->
<script>
const scope = document.getElementById("applyScope");
const box = document.getElementById("categoryBox");

scope.addEventListener("change", () => {
  if(scope.value === "selected"){
    box.style.display = "block";
  } else {
    box.style.display = "none";
  }
});
</script>

</body>
</html>